!function(){"use strict";function a(a){var d=c(b,a||{});this.create(d)}var b={ellipsis:"â€¦",debounce:100,responsive:!0,class:".clamp",lines:2,portrait:null,break_word:!0},c=function(a,b){var c={};for(var d in a)c[d]=a[d];for(var e in b)c[e]=b[e];return c};a.prototype={conf:{},prop:{},lines:{},temp:null,cloneCache:function(a){for(var b=[],c=0;c<a.length;c++)b.push(a[c].innerHTML);return b},create:function(a){if(this.conf=a,this.lines={get current(){return a.portrait&&window.innerHeight>window.innerWidth?a.portrait:a.lines}},this.conf.responsive){this.temp=this.cloneCache(document.querySelectorAll(this.conf.class));var b,c=function(a){clearTimeout(b),b=setTimeout(function(){this.add()}.bind(this),this.conf.debounce)};window.addEventListener("resize",c.bind(this),!1),window.removeEventListener("beforeunload",c.bind(this),!1)}this.add()},createProp:function(a){this.prop={get height(){var b=a.getBoundingClientRect();return parseInt(b.bottom-b.top,10)},get lineheight(){var b=getComputedStyle(a).getPropertyValue("line-height");return String("normal|initial|inherit").indexOf(b)>-1&&(b=parseInt(getComputedStyle(a).getPropertyValue("font-size"),10)+2),parseInt(b,10)}}},add:function(){for(var a=document.querySelectorAll(this.conf.class),b=0;b<a.length;b++)this.conf.responsive&&this.temp&&this.temp[b]!=a[b].innerHTML&&(a[b].innerHTML=this.temp[b]),this.createProp(a[b]),this.isNotCorrect()&&(a[b].childNodes.length&&a[b].childNodes.length>1?this.handleChilds(a[b]):a[b].childNodes.length&&1===a[b].childNodes.length&&3===a[b].childNodes[0].nodeType&&this.simpleText(a[b]))},breakWord:function(a,b,c){var d=a.split(" ");if(d.pop(),c&&d.pop(),!b)return d[d.length-1]&&(d[d.length-1]=d[d.length-1].replace(/(,$)/g,"").replace(/(\.$)/g,"")),d.push(this.conf.ellipsis),d.join(" ");if(d[d.length-1])return d[d.length-1]=d[d.length-1].replace(/(,$)/g,"").replace(/(\.$)/g,""),d.push(this.conf.ellipsis),[d.join(" "),b];if(!d[d.length-1]&&b){var e=" "+b.trim().replace(/(,$)/g,"").replace(/(\.$)/g,"")+" ";return d.push(this.conf.ellipsis),[d.join(" "),e]}},simpleText:function(a){for(var b=a.childNodes[0].nodeValue;this.prop.height>this.prop.lineheight*this.lines.current;)a.childNodes[0].nodeValue=b.slice(0,-1),b=a.childNodes[0].nodeValue;this.conf.break_word?(a.childNodes[0].nodeValue=b.slice(0,-this.conf.ellipsis.length)+this.conf.ellipsis,this.isNotCorrect()&&(a.childNodes[0].nodeValue=" "+a.childNodes[0].nodeValue.slice(0,-(this.conf.ellipsis.length+1)).trim().slice(0,-this.conf.ellipsis.length)+this.conf.ellipsis)):(a.childNodes[0].nodeValue=this.breakWord(a.childNodes[0].nodeValue),this.isNotCorrect()&&(a.childNodes[0].nodeValue=this.breakWord(a.childNodes[0].nodeValue,null,!0)))},isNotCorrect:function(){return this.prop.height>this.prop.lineheight*this.lines.current},processBreak:function(a,b,c){var d=this.breakWord(a.innerHTML||a.nodeValue,b.innerHTML||b.nodeValue,c);a.innerHTML?a.innerHTML=d[0]:a.nodeValue=d[0],b.innerHTML?b.innerHTML=d[1]:b.nodeValue=d[1]},handleChilds:function(a){for(var b,c=a.childNodes,d=c.length-1;d>=0;d--){var e;if(3===c[d].nodeType?(e=c[d].nodeValue,c[d].nodeValue=""):(e=getComputedStyle(c[d]).getPropertyValue("display"),c[d].style.display="none"),this.prop.height<=this.prop.lineheight*this.lines.current){if(3===c[d].nodeType){for(c[d].nodeValue=e,b=c[d].nodeValue;this.prop.height>this.prop.lineheight*this.lines.current;)c[d].nodeValue=b.slice(0,-1),b=c[d].nodeValue;if(this.conf.break_word){if(c[d].nodeValue=b.slice(0,-this.conf.ellipsis.length)+this.conf.ellipsis,this.isNotCorrect()){if(c[d].nodeValue=" "+c[d].nodeValue.slice(0,-this.conf.ellipsis.length).trim().slice(0,-this.conf.ellipsis.length),!(c[d].nodeValue.length>1))continue;c[d].nodeValue=c[d].nodeValue.slice(0,-this.conf.ellipsis.length)+this.conf.ellipsis}}else{if(!c[d].innerHTML&&!c[d].nodeValue)continue;if(this.processBreak(c[d],c[d-1]),this.isNotCorrect()&&(this.processBreak(c[d],c[d-1],!0),this.isNotCorrect())){a.removeChild(c[d]);continue}}}else{for(c[d].style.display=e,b=c[d].innerHTML;this.prop.height>this.prop.lineheight*this.lines.current;)c[d].innerHTML=b.slice(0,-1),b=c[d].innerHTML;if(this.conf.break_word){if(c[d].innerHTML=b.slice(0,-this.conf.ellipsis.length)+this.conf.ellipsis,this.isNotCorrect()){if(c[d].innerHTML=" "+c[d].innerHTML.slice(0,-this.conf.ellipsis.length).trim().slice(0,-this.conf.ellipsis.length),!(c[d].innerHTML.length>1))continue;c[d].innerHTML=c[d].innerHTML.slice(0,-this.conf.ellipsis.length)+this.conf.ellipsis}}else{if(!c[d].innerHTML&&!c[d].nodeValue)continue;if(this.processBreak(c[d],c[d-1]),this.isNotCorrect()&&(this.processBreak(c[d],c[d-1],!0),this.isNotCorrect())){a.removeChild(c[d]);continue}}}break}a.removeChild(c[d])}}};var d=function(b){return new a(b)};return"function"==typeof define&&define.amd&&define("ellipsis",[],function(){return d}),self.Ellipsis=d,d}();